(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1279e6dc"],{1148:function(e,t,n){"use strict";var r=n("da84"),o=n("5926"),i=n("577e"),a=n("1d80"),c=r.RangeError;e.exports=function(e){var t=i(a(this)),n="",r=o(e);if(r<0||r==1/0)throw c("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}},"2ea7":function(e,t,n){"use strict";n.r(t);var r=n("f2bf");function o(e,t,n,o,i,a){var c=Object(r["resolveComponent"])("QuestionnaireMain");return Object(r["openBlock"])(),Object(r["createBlock"])(c)}var i=n("8afd"),a=function(e){return Object(r["pushScopeId"])("data-v-7cd9101f"),e=e(),Object(r["popScopeId"])(),e},c={key:0,class:"saved"},s={key:0,class:"infoModule"},u={key:1,class:"loading flex items-center justify-center"},d=a((function(){return Object(r["createElementVNode"])("div",null,"Загрузка анкеты...",-1)})),l=[d],f={key:2,class:"loading flex items-center justify-center"},m=a((function(){return Object(r["createElementVNode"])("div",null,"Отправка анкеты...",-1)})),h=[m];function v(e,t,n,o,i,a){var d=Object(r["resolveComponent"])("Header"),m=Object(r["resolveComponent"])("Container"),v=Object(r["resolveComponent"])("NavigationBlock");return e.loading||e.pending?e.loading?(Object(r["openBlock"])(),Object(r["createElementBlock"])("section",u,l)):e.pending?(Object(r["openBlock"])(),Object(r["createElementBlock"])("section",f,h)):Object(r["createCommentVNode"])("",!0):(Object(r["openBlock"])(),Object(r["createElementBlock"])("section",{key:0,class:Object(r["normalizeClass"])(["questionnaire flex direction-column items-center",e.mode])},[Object(r["createVNode"])(d,{qqstatus:e.qqstatus,seconds:e.seconds,targets:e.questionnaire.targets,role:e.user.role,onOnSeconds:e.onSeconds,onEditQuestionnaire:e.editQuestionnaire,onStopQuestionnaire:e.stopQuestionnaire,onPauseQuestionnaire:e.pauseQuestionnaire,onSaveQuestionnaireInterval:e.saveQuestionnaireInterval},null,8,["qqstatus","seconds","targets","role","onOnSeconds","onEditQuestionnaire","onStopQuestionnaire","onPauseQuestionnaire","onSaveQuestionnaireInterval"]),Object(r["createVNode"])(m,{onModeChange:e.modeChange,onAddStudentTarget:e.addStudentTarget,onSelectQuestionnaireSection:e.selectQuestionnaireSection,onSelectTarget:e.selectTarget,onFinish:e.finish,onSaveStudentQuestionnaire:e.saveStudentQuestionnaire,onCombine:e.combine,onUncombine:e.uncombine,mode:e.mode,pending:e.pending,course:e.course,correctSection:e.correctSection,questionnaire:e.questionnaire,questionnaireStudent:e.questionnaireStudent,questionnaireMode:e.questionnaireMode,role:e.user.role},null,8,["onModeChange","onAddStudentTarget","onSelectQuestionnaireSection","onSelectTarget","onFinish","onSaveStudentQuestionnaire","onCombine","onUncombine","mode","pending","course","correctSection","questionnaire","questionnaireStudent","questionnaireMode","role"]),Object(r["createVNode"])(v),Object(r["createVNode"])(r["Transition"],{name:"fade"},{default:Object(r["withCtx"])((function(){return[e.saved?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",c,"Анкета сохранена...")):Object(r["createCommentVNode"])("",!0)]})),_:1}),"one"===e.course?(Object(r["openBlock"])(),Object(r["createElementBlock"])("div",s)):Object(r["createCommentVNode"])("",!0)],2))}var p=n("b85c"),b=n("1da1"),g=n("5530"),q=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),n("159b"),n("7db0"),n("ac1f"),n("1276"),n("99af"),n("4de4"),n("b0c0"),n("5502")),j=n("7ae0"),O=n("681c"),y=function(e){return Object(r["pushScopeId"])("data-v-2a486236"),e=e(),Object(r["popScopeId"])(),e},w=y((function(){return Object(r["createElementVNode"])("path",{d:"M2 22.5L20.5 4L39 22.5",stroke:"black","stroke-width":"5"},null,-1)})),S=[w];function N(e,t,n,o,i,a){return Object(r["openBlock"])(),Object(r["createBlock"])(r["Transition"],{name:"fade"},{default:Object(r["withCtx"])((function(){return[e.showNavigation?(Object(r["openBlock"])(),Object(r["createElementBlock"])("svg",{key:0,onClick:t[0]||(t[0]=function(){return e.scroll&&e.scroll.apply(e,arguments)}),width:"41",height:"25",viewBox:"0 0 41 25",fill:"none",xmlns:"http://www.w3.org/2000/svg"},S)):Object(r["createCommentVNode"])("",!0)]})),_:1})}var _=Object(i["defineComponent"])({name:"QuestionnaireNavigationBlock",data:function(){return{showNavigation:!1}},created:function(){window.addEventListener("scroll",this.onScroll)},unmounted:function(){window.removeEventListener("scroll",this.onScroll)},methods:{onScroll:function(){this.showNavigation=window.scrollY>500},scroll:function(){this.jq("html, body").stop().animate({scrollTop:0},500)}}}),T=(n("4519"),n("6b0d")),E=n.n(T);const k=E()(_,[["render",N],["__scopeId","data-v-2a486236"]]);var x=k,Q=(n("caad"),n("2532"),n("d81d"),n("a9e3"),n("0613"));function I(e){Q["a"].commit("createNotification",{status:"error",message:e})}function C(e,t,n){t.error=!0,e.correctSection="target",I(n),setTimeout((function(){var t,n=e.jq('[data-id="targets"] .error'),r=Math.abs((null===(t=n.offset())||void 0===t?void 0:t.top)||200);e.jq("html, body").stop().animate({scrollTop:r-200},0)}),100)}function M(e,t){var n,r=Object(p["a"])(t.inputs);try{for(r.s();!(n=r.n()).done;){var o=n.value;if(o.required&&!t.data[o.id]&&0!==t.data[o.id])return C(e,o,'Заполните поле "'.concat(o.name||o.placeholder,'"')),!1;if(o.required&&o.drop&&!o.uncheck&&!t.data[o.id+"_id"])return C(e,o,'Вам необходимо выбрать вариант из списка в поле "'.concat(o.name,'"!')),!1;o.error=!1}}catch(i){r.e(i)}finally{r.f()}return!0}function $(e,t){var n=t.filter((function(e){return e.default.includes("portfolio-instrument-")})),r=n.map((function(e){return e.modules})).reduce((function(e,t){return e.concat(t)})),o=Math.ceil10(r.filter((function(e){return e.data.price&&e.data.name})).map((function(e){return e.data})).reduce((function(e,t){return e+Number(t.percent)}),0),-2);if(o<90)return I("Вы не полностью заполнили портфель эксперта. Заполнено ".concat(o,"%. Пожалуйста, добавьте активы.")),e.correctSection="expert",e.jq("html, body").stop().animate({scrollTop:0},0),!1;var i,a=r.filter((function(e){return e.data.price&&e.data.name})).map((function(e){return e.data})),c=Object(p["a"])(a);try{for(c.s();!(i=c.n()).done;){var s=i.value;if(0===Number(s.percent)&&0===Number(s.number_papers))return I('У Вас есть "нулевой" инструмент в портфеле эксперта!'),e.correctSection="expert",e.jq("html, body").stop().animate({scrollTop:0},0),!1}}catch(u){c.e(u)}finally{c.f()}return!0}function R(e,t){var n,r=Object(p["a"])(t);try{for(r.s();!(n=r.n()).done;){var o,i=n.value,a=Object(p["a"])(i.modules);try{for(a.s();!(o=a.n()).done;){var c,s=o.value,u=Object(p["a"])(s.inputs);try{for(u.s();!(c=u.n()).done;){var d=c.value;if(d.required&&!s.data[d.id]&&0!==s.data[d.id])return C(e,d,'Заполните поле "'.concat(d.name||d.placeholder,'"')),!1;if(d.required&&d.drop&&!d.uncheck&&!s.data[d.id+"_id"])return C(e,d,'Вам необходимо выбрать вариант из списка в поле "'.concat(d.name,'"!')),!1;d.error=!1}}catch(l){u.e(l)}finally{u.f()}}}catch(l){a.e(l)}finally{a.f()}}}catch(l){r.e(l)}finally{r.f()}return!0}var B=function(e){var t,n=Object(p["a"])(e.questionnaire.targets);try{for(n.s();!(t=n.n()).done;){var r=t.value,o=["type","conclusion"];if(!M(e,r.main))return!1;for(var i=0,a=o;i<a.length;i++){var c=a[i];if(!R(e,r[c].sections))return!1}if(!$(e,r.portfolios.expert.sections))return!1}}catch(s){n.e(s)}finally{n.f()}return!0},A=n("2909"),P=(n("b680"),n("b2dc"));function L(e,t){e.targets.forEach((function(e){for(var n=Object(P["c"])(e.type.sections[2].modules[0].data.amount,e.type.sections[2].modules[0].data.currency_id,e.main.data.currency_id),r=e.main.data.currency_id,o=e.portfolios.student,i=[1,2],a=0,c=i;a<c.length;a++){var s,u=c[a],d=Object(p["a"])(o.sections[u].modules);try{for(d.s();!(s=d.n()).done;){var l=s.value;if(0!==l.data.percent||!l.data.number_papers){var f=Object(P["j"])(l.data,r,t),m=Math.floor(n*(+l.data.percent/100)/f);if(!isNaN(m)){var h=f*m,v=Math.ceil10(h/n*100,-2);l.data.number_papers=m,l.data.percent=v}}}}catch(b){d.e(b)}finally{d.f()}}}))}function F(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"",s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"",u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:"";console.log('[data-id="'.concat(o,'"] ').concat(i?'[data-id="target-'.concat(i,'"]'):""," ").concat(a?'[data-id="'.concat(a,'"]'):""," ").concat(u?".target--".concat(u):""," ").concat(c?'[data-id="section-'.concat(c,'"]'):""," ").concat(s?'[data-id="module-'.concat(s,'"]'):"",' [data-id="').concat(t.id,'"]')),i&&(e.correctSection=a||"target",e.questionnaire.targets.forEach((function(e){return e.selected=!1})),e.questionnaire.targets.find((function(e){return e.id===i})).selected=!0),setTimeout((function(){var r;t.error=!0;var d=e.jq('[data-id="'.concat(o,'"] ').concat(i?'[data-id="target-'.concat(i,'"]'):""," ").concat(a?'[data-id="'.concat(a,'"]'):""," ").concat(u?".target--".concat(u):""," ").concat(c?'[data-id="section-'.concat(c,'"]'):""," ").concat(s?'[data-id="module-'.concat(s,'"]'):"",' [data-id="').concat(t.id,'"]')),l=Math.abs((null===(r=d.offset())||void 0===r?void 0:r.top)||160);e.jq("html, body").stop().animate({scrollTop:l-160},0),e.jq(".questionnaire").stop().animate({scrollTop:l-160},0),e.$store.commit("createNotification",{status:"error",message:n})}),200)}function U(e){var t=function(t,n){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",u=Object(p["a"])(t.inputs);try{for(u.s();!(r=u.n()).done;){var d=r.value;if(!t.data[d.id]&&0!==t.data[d.id]&&d.required)return F(e,d,'Заполните поле "'.concat(d.name||d.placeholder,'"'),t,n,o,i,a,c,s),!1;if(!t.data[d.id+"_id"]&&d.drop&&d.required&&!d.uncheck)return F(e,d,'Вам необходимо выбрать вариант из списка в поле "'.concat(d.name,'"!'),t,n,o,i,a,c,s),!1;d.error=!1}}catch(l){u.e(l)}finally{u.f()}return!0};for(var n in e.questionnaire)if(Object.hasOwnProperty.call(e.questionnaire,n)){var r=e.questionnaire[n];if(Array.isArray(r)){var o,i=Object(p["a"])(r);try{for(i.s();!(o=i.n()).done;){var a=o.value,c=["type","conclusion"];if(!t(a.main,n,a.id))return!1;for(var s=0,u=c;s<u.length;s++)for(var d=u[s],l=0;l<a[d].sections.length;l++){var f=a[d].sections[l];if(f.show)for(var m=0;m<f.modules.length;m++){var h=f.modules[m];if(!t(h,n,a.id,"",l,m,d))return!1}}if(0===a.status.existing){var v=e.jq(".questionnaire--container").height()+e.jq('[data-id="'.concat(n,'"] [data-id="target-').concat(a.id,'"] [data-id="existing"]')).offset().top-window.innerHeight;return e.jq(".questionnaire").stop().animate({scrollTop:v},500),e.$store.commit("createNotification",{status:"error",message:"Необходимо выбрать наличие существующего профиля! Есть или нет"}),!1}for(var b in a.portfolios)if(Object.hasOwnProperty.call(a.portfolios,b)){var g=a.portfolios[b];if("existingPortfolio"===g.id&&1!==a.status.existing)continue;if("studentPortfolio"===g.id&&1!==a.status.student)continue;if("expertPortfolio"===g.id&&1!==a.status.expert)continue;for(var q=0;q<g.sections.length;q++){var j=g.sections[q];if(j.show&&(!j.optional||j.selected))for(var O=0;O<j.modules.length;O++){var y=j.modules[O];if(!t(y,n,a.id,b,q,O))return!1}}}}}catch(w){i.e(w)}finally{i.f()}}else if(!t(r.module,n))return!1}return!0}function V(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"",s=arguments.length>8&&void 0!==arguments[8]?arguments[8]:"",u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:"";e.mode="list",i&&(e.questionnaire.targets.forEach((function(e){return e.selected=!1})),e.questionnaire.targets.find((function(e){return e.id===i})).selected=!0),console.log('[data-id="'.concat(o,'"] ').concat(i?'[data-id="target-'.concat(i,'"]'):""," ").concat(a?'[data-id="'.concat(a,'"]'):""," ").concat(u?".target--".concat(u):""," ").concat(c?'[data-id="section-'.concat(c,'"]'):""," ").concat(s?'[data-id="module-'.concat(s,'"]'):"",' [data-id="').concat(t.id,'"]')),setTimeout((function(){var r;t.error=!0;var d=e.jq('[data-id="'.concat(o,'"] ').concat(i?'[data-id="target-'.concat(i,'"]'):""," ").concat(a?'[data-id="'.concat(a,'"]'):""," ").concat(u?".target--".concat(u):""," ").concat(c?'[data-id="section-'.concat(c,'"]'):""," ").concat(s?'[data-id="module-'.concat(s,'"]'):"",' [data-id="').concat(t.id,'"]')),l=Math.abs((null===(r=d.offset())||void 0===r?void 0:r.top)||160);e.jq("html, body").stop().animate({scrollTop:l-160},0),e.jq(".questionnaire").stop().animate({scrollTop:l-160},0),e.$store.commit("createNotification",{status:"error",message:n})}),200)}function D(e){for(var t=[1,2],n=0,r=t;n<r.length;n++){var o,i=r[n],a=Object(p["a"])(e[i].modules);try{for(a.s();!(o=a.n()).done;){var c=o.value;if(0===Number(c.data.percent)&&0===Number(c.data.number_papers)&&c.data.name&&c.data.price)return!1}}catch(s){a.e(s)}finally{a.f()}}return!0}function Y(e){var t=function(t,n){var r,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"",u=Object(p["a"])(t.inputs);try{for(u.s();!(r=u.n()).done;){var d=r.value;if(!t.data[d.id]&&0!==t.data[d.id]&&d.required)return V(e,d,'Заполните поле "'.concat(d.name||d.placeholder,'"'),t,n,o,i,a,c,s),!1;if(!t.data[d.id+"_id"]&&d.drop&&d.required&&!d.uncheck)return V(e,d,'Вам необходимо выбрать вариант из списка в поле "'.concat(d.name,'"!'),t,n,o,i,a,c,s),!1;d.error=!1}}catch(l){u.e(l)}finally{u.f()}return!0};for(var n in e.questionnaire)if(Object.hasOwnProperty.call(e.questionnaire,n)){var r=e.questionnaire[n];if(Array.isArray(r)){var o,i=Object(p["a"])(r);try{for(i.s();!(o=i.n()).done;){var a,c=o.value,s=["type","conclusion"];if(!t(c.main,n,c.id))return!1;for(var u=0,d=s;u<d.length;u++)for(var l=d[u],f=0;f<c[l].sections.length;f++){var m=c[l].sections[f];if(m.show)for(var h=0;h<m.modules.length;h++){var v=m.modules[h];if(!t(v,n,c.id,"",f,h,l))return!1}}var b=c.portfolios.student.sections[1].modules.filter((function(e){return e.data.name&&e.data.price}));if(0===b.length){var g=e.course===j["b"].ONE?"Вы не добавили инструменты в Цель №".concat(c.id,". Мы не можем проверить пустой портфель. Пожалуйста, добавьте активы или удалите Цель."):"Вы не добавили инструменты в Цель. Мы не можем проверить пустой портфель. Пожалуйста, добавьте активы или проверьте сумму вашей цели.";return e.$store.commit("createNotification",{status:"error",message:g,timeout:8e3}),e.emitter.emit("changeTarget",c.id),!1}var q=c.portfolios.student.sections.filter((function(e){return e.default.includes("portfolio-instrument-")})),O=Number((a=[]).concat.apply(a,Object(A["a"])(q.map((function(e){return e.modules})))).map((function(e){return e.data})).reduce((function(e,t){return e+Number(t.percent)}),0).toFixed(2));if(O<90){var y=e.course===j["b"].ONE?"Вы не полностью заполнили портфель на всю сумму в Цели №".concat(c.id,". Заполнено ").concat(O,"%. Пожалуйста, добавьте активы или удалите Цель."):"Вы не полностью заполнили портфель на всю сумму цели. Заполнено ".concat(O,"%. Пожалуйста, добавьте активы или проверьте сумму вашей цели.");return e.$store.commit("createNotification",{status:"error",message:y,timeout:8e3}),e.emitter.emit("changeTarget",c.id),!1}}}catch(w){i.e(w)}finally{i.f()}}else if(!t(r.module,n))return!1}return!0}var W=Object(i["defineAsyncComponent"])((function(){return n.e("chunk-758cec43").then(n.bind(null,"0b34"))})),H=Object(i["defineAsyncComponent"])((function(){return Promise.all([n.e("chunk-4efb2ac6"),n.e("chunk-3514ee4d")]).then(n.bind(null,"400e"))})),J=Object(i["defineComponent"])({name:"QuestionnaireMain",data:function(){return{seconds:0,questionnaire_id:this.$.attrs._id,pending:!1,loading:!0,course:j["b"].ONE,correctSection:"target",mode:"list",timeout:0,interval:Date.now(),qqstatus:"",saved:!1}},computed:Object(g["a"])({},Object(q["b"])(["user","questionnaire","questionnaireStudent","questionnaireStatus","questionnaireMode"])),created:function(){this.getQuestionnaire(),this.getInvestments(),this.$store.dispatch("getConvert")},provide:function(){var e=this;return{role:Object(i["computed"])((function(){return e.user.role})),questionnaire_id:Object(i["computed"])((function(){return e.questionnaire_id}))}},mounted:function(){window.addEventListener("scroll",this.onScroll),this.emits()},beforeUnmount:function(){clearInterval(this.timeout),this.timeout=0},unmounted:function(){this.jq("body").css("height","100%"),this.jq("body").unbind("click"),this.emitter.off("verification",this.verificationEmitter),this.emitter.off("removeStudentTarget",this.removeStudentTargetEmitter),window.removeEventListener("scroll",this.onScroll),this.unsubscribeQuestionnaire()},methods:{subscribeQuestionnaire:function(e){var t=this;this.socket.emit("createRoom",{id:String(e._id),role:this.user.role}),this.socket.on("check",(function(n){var r=n.status;r?(t.$router.push("/expert/notverified"),t.$store.commit("createNotification",{status:"error",message:"Студент редактирует работу!"})):t.fillQuestionnaire(e)}))},unsubscribeQuestionnaire:function(){this.socket.emit("leaveRoom",{id:String(this.questionnaire_id)})},emits:function(){this.emitter.on("verification",this.verificationEmitter),this.emitter.on("removeStudentTarget",this.removeStudentTargetEmitter)},verificationEmitter:function(){this.verification()},removeStudentTargetEmitter:function(e){this.$store.commit("removeTarget",e-1),this.questionnaire.targets[0].selected=!0},onScroll:function(){var e=this;this.jq(".target .portfolio").offset()&&this.jq(".target").toArray().forEach((function(t){e.jq(t).find(".portfolio").toArray().forEach((function(n){var r,o=(null===(r=e.jq(n).offset())||void 0===r?void 0:r.top)||0,i=o+(e.jq(n).height()||0);if(o<window.scrollY&&i>window.scrollY){var a,c=null===(a=e.jq(t).attr("data-id"))||void 0===a?void 0:a.split("-").pop(),s=e.jq(n).attr("data-id"),u={existing:"Существующий портфель",student:"Портфель студента",expert:"Портфель эксперта"};e.jq(".infoModule").html("".concat(u[s]," ").concat(e.course===j["b"].ONE?"(Цель ".concat(c,")"):""))}}));var n=e.jq(".target .portfolio").offset()||{top:0};n.top>window.scrollY&&e.jq(".infoModule").html("")}))},getQuestionnaire:function(){var e,t=this;this.course=(null===(e=this.user.course)||void 0===e?void 0:e.type)||j["b"].ONE,this.$store.commit("clearQuestionnaire",{course:this.course,role:this.user.role}),this.axios.get("/api/questionnaire/id/".concat(this.questionnaire_id)).then((function(e){t.$store.commit("clearQuestionnaire",{course:t.course,role:t.user.role,owner:e.data.owner}),e.data.status===j["e"].NOTVERIFIED?t.subscribeQuestionnaire(e.data):t.fillQuestionnaire(e.data)})).catch((function(e){t.$store.commit("createNotification",{status:"error",message:404===e.response.status?"Анкета не найдена!":"Что-то пошло не так!"}),t.$router.push(t.user.role===j["g"].STUDENT?"/student/works":"/process")}))},fillQuestionnaire:function(e){var t=this;return Object(b["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.seconds=e.seconds,t.course=e.course.type,t.qqstatus=e.status,n.next=5,t.$store.commit("fillQuestionnaireData",{questionnaireData:e,course:t.course,role:t.user.role});case 5:t.disableInputs(),t.jq("body").css("height","auto"),t.loading=!1;case 8:case"end":return n.stop()}}),n)})))()},disableInputs:function(){var e=this;"list"!==this.mode||this.questionnaireStatus||setTimeout((function(){e.jq("input, textarea").prop("disabled",!0),e.jq(".input img").css("pointer-events","none")}),150)},saveStudentQuestionnaire:function(){var e={content_STUDENT:Object(O["a"])(this.questionnaireStudent)};this.API.questionnaire.saveStudentQuestionnaire(this.questionnaire_id,e)},combine:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n={content_COMBINE_EXPERT:Object(O["a"])(e.questionnaire),content_COMBINE_STUDENT:Object(O["a"])(e.questionnaireStudent)},t.next=3,e.API.questionnaire.onCombine(e.questionnaire_id,n);case 3:e.$store.commit("setUncombine");case 4:case"end":return t.stop()}}),t)})))()},uncombine:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.API.questionnaire.onUnCombine(e.questionnaire_id);case 2:return n=t.sent,t.next=5,e.$store.commit("fillQuestionnaireData",{questionnaireData:n.data,course:e.course,role:e.user.role});case 5:case"end":return t.stop()}}),t)})))()},finish:function(){(this.course!==j["b"].ONE||U(this))&&(this.course!==j["b"].TWO||B(this))&&(this.jq("body").css("height","100%"),this.questionnaireSave())},addStudentTarget:function(){var e=this;this.mode="list",this.questionnaire.targets.forEach((function(e){return e.selected=!1})),this.questionnaire.targets[this.questionnaire.targets.length-1].selected=!0,setTimeout((function(){e.jq("html, body").animate({scrollTop:(e.jq("[data-id='target-".concat(e.questionnaire.targets.length,"']")).offset()||{top:170}).top-170},0)}),100)},modeChange:function(){this.mode="list"===this.mode?"table":"list","table"===this.mode&&L(this.questionnaire,this.course),this.disableInputs(),this.jq("html, body").animate({scrollTop:0},0)},verification:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var n,r,o,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(Y(e)){t.next=2;break}return t.abrupt("return");case 2:if(D(e.questionnaire.targets[0].portfolios.student.sections)){t.next=8;break}return r=e.jq('[data-id="studentPortfolio"]'),o=Math.abs((null===(n=r.offset())||void 0===n?void 0:n.top)||100),e.jq("html, body").stop().animate({scrollTop:o-100},0),e.jq(".questionnaire").stop().animate({scrollTop:o-100},0),t.abrupt("return",e.$store.commit("createNotification",{status:"error",message:'У Вас есть "нулевой" инструмент в основном портфеле! Он подсвечен красным!'}));case 8:e.pending=!0,e.jq("body").css("height","100%"),i={content_STUDENT:Object(O["a"])(e.questionnaire),seconds:e.seconds},e.axios.put("/api/questionnaire/".concat(e.questionnaire_id,"/verification"),i).then((function(){e.$router.push("/student/works")})).catch((function(t){e.pending=!1,e.jq("body").css("height","auto"),e.$store.commit("createNotification",{status:"error",message:t.response.data.message})}));case 12:case"end":return t.stop()}}),t)})))()},questionnaireSave:function(){this.pending=!0,this.finishQuestionnaire()},finishQuestionnaire:function(){var e={seconds:this.seconds};e["content_EXPERT"]=Object(O["a"])(this.questionnaire);var t=this.collectOptions(e,"patch","api/questionnaire/finish",this.questionnaire_id);this.questionnaireRequest(t,!1,!0)},selectQuestionnaireSection:function(e){this.correctSection=e,this.disableInputs()},selectTarget:function(e){this.questionnaire.targets.forEach((function(e){return e.selected=!1})),this.questionnaire.targets.find((function(t){return t.id===e})).selected=!0,this.disableInputs()},checkFiles:function(){if(this.course===j["b"].ONE)return!0;var e,t=Object(p["a"])(this.questionnaire.targets);try{for(t.s();!(e=t.n()).done;){var n=e.value;for(var r in n.portfolios){if("expert"===r)return!0;var o=n.portfolios[r];if(0===o.sections[2].files.length&&o.sections[2].modules.filter((function(e){return e.data.name&&e.data.price})).length>0)return this.$store.commit("createNotification",{status:"error",message:'Прикрепите скриншот таблицы для тактической идеи в пункте "'.concat(o.name,'"')}),!1}}}catch(i){t.e(i)}finally{t.f()}return!0},onSeconds:function(){this.seconds++},saveQuestionnaireInterval:function(){var e=this;this.timeout=setInterval((function(){e.editQuestionnaire(!1)}),6e3)},pauseQuestionnaire:function(){if(this.user.role===j["g"].STUDENT)return this.stopQuestionnaire();this.$store.commit("onQuestionnaireStatus",!1),this.disableInputs(),clearInterval(this.timeout)},stopQuestionnaire:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t={seconds:this.seconds};t["content_"+this.user.role]=Object(O["a"])(this.questionnaire);var n=this.collectOptions(t,"put","api/questionnaire/stop",this.questionnaire_id);this.questionnaireRequest(n,e)},editQuestionnaire:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t={seconds:this.seconds};t["content_"+this.user.role]=Object(O["a"])(this.questionnaire);var n=this.collectOptions(t,"put","api/questionnaire",this.questionnaire_id);this.questionnaireRequest(n,e)},collectOptions:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return{method:t,url:"/".concat(n,"/").concat(r),data:e}},questionnaireRequest:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.axios(e).then((function(o){localStorage.getItem("saveMode")&&localStorage.removeItem("saveMode"),n.questionnaire_id=o.data._id,"put"===e.method&&t&&n.$router.push(n.user.role===j["g"].STUDENT?"/student/works":"/expert/notverified"),r&&n.$router.push({path:"/preview/"+n.questionnaire_id,query:{collection:"true"}}),t||(n.saved=!0,setTimeout((function(){n.saved=!1}),3e3))})).catch((function(e){var t,r;if(n.pending=!1,400===(null===e||void 0===e||null===(t=e.response)||void 0===t?void 0:t.status)||404===(null===e||void 0===e||null===(r=e.response)||void 0===r?void 0:r.status))return clearInterval(n.timeout),n.$router.push("/auth");n.$store.commit("createQuestionnaireError",{err:e,questionnaire:n.questionnaire_id,status:"error"}),n.jq("body").css("height","auto")}))},getInvestments:function(){var e=this;return Object(b["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.API.instrument.getInstruments();case 2:n=t.sent,e.$store.commit("setInstruments",n.data);case 4:case"end":return t.stop()}}),t)})))()}},components:{Header:W,Container:H,NavigationBlock:x}});n("de07");const X=E()(J,[["render",v],["__scopeId","data-v-7cd9101f"]]);var z=X,K=Object(i["defineComponent"])({name:"Questionnaire",components:{QuestionnaireMain:z}});const G=E()(K,[["render",o]]);t["default"]=G},3148:function(e,t,n){},4519:function(e,t,n){"use strict";n("c4ff")},"681c":function(e,t,n){"use strict";var r=n("b85c");n("d81d"),n("b0c0");function o(e){return e.module?{module:{data:e.module.data}}:e.map((function(e){return{id:e.id,status:e.status,name:e.name,main:{data:e.main.data},type:{id:e.type.id,name:e.type.name,sections:e.type.sections.map((function(e){return{modules:e.modules.map((function(e){return{data:e.data}})),default:e.default}}))},conclusion:{sections:e.conclusion.sections.map((function(e){return{modules:e.modules.map((function(e){return{data:e.data}})),default:e.default}}))},portfolios:{existing:{sections:e.portfolios.existing.sections.map((function(e){return{modules:e.modules.map((function(e){return{data:e.data}})),default:e.default,optional:e.optional,selected:e.selected,files:e.files}}))},student:{sections:e.portfolios.student.sections.map((function(e){return{modules:e.modules.map((function(e){return{data:e.data}})),default:e.default,optional:e.optional,selected:e.selected,files:e.files}}))},expert:{sections:e.portfolios.expert.sections.map((function(e){return{modules:e.modules.map((function(e){return{data:e.data}})),default:e.default}}))}}}}))}t["a"]=function(e){var t,n={},i=Object.typedKeys(e),a=Object(r["a"])(i);try{for(a.s();!(t=a.n()).done;){var c=t.value;if(Object.hasOwnProperty.call(e,c)){var s=e[c];n[c]={id:c,data:o(s)}}}}catch(u){a.e(u)}finally{a.f()}return n}},b2dc:function(e,t,n){"use strict";n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return q})),n.d(t,"d",(function(){return p})),n.d(t,"f",(function(){return m})),n.d(t,"k",(function(){return s})),n.d(t,"g",(function(){return h})),n.d(t,"h",(function(){return v})),n.d(t,"i",(function(){return u})),n.d(t,"j",(function(){return l}));var r=n("b85c"),o=(n("7db0"),n("d3b7"),n("ac1f"),n("5319"),n("b680"),n("a9e3"),n("159b"),n("498a"),n("b0c0"),n("0613")),i=n("7ae0"),a=[{id:"NOT_PERIOD",period:0,months:0},{id:"MONTHLY",period:12,months:1},{id:"QUARTERLY",period:4,months:3},{id:"SEMIANNUALLY",period:2,months:6},{id:"ANNUALLY",period:1,months:12}],c=function(e){var t=o["a"].getters.currencyList.find((function(t){return t._id===e}));return t?t.sign:"!"},s=function(e){return Number(e).toFixed(1).replace(/\B(?=(\d{3})+(?!\d))/g," ")},u=function(e,t,n){var r=o["a"].getters.currencies,a=n===i["b"].TWO&&e.lot?e.lot:1;return e.price*a*e.number_papers/r[e["currency_".concat(n,"_id")]]*r[t]},d=function(e,t,n){var r=o["a"].getters.currencies;return Math.ceil10(e/r[t]*r[n],-2)},l=function(e,t,n){var r=o["a"].getters.currencies,a=n===i["b"].TWO&&e.lot?e.lot:1;return e.price*a/r[e["currency_".concat(n,"_id")]]*r[t]},f=function(e,t){var n=o["a"].getters.currencies;return e.reduce((function(e,r){return e+r.data.amount/n[r.data.currency_id]*n[t]}),0).toFixed(1)},m=function(e,t,n){var r=o["a"].getters.currencies;return s(e.reduce((function(e,o){return e+o.price*(n===i["b"].TWO&&o.lot?o.lot:1)*o.number_papers/r[o["currency_".concat(n,"_id")]]*r[t]}),0))},h=function(e,t,n){for(var a=arguments.length,c=new Array(a>3?a-3:0),s=3;s<a;s++)c[s-3]=arguments[s];var u=o["a"].getters.currencies,d={};c.forEach((function(o,a){d[a]||(d[a]=0);var s,l=Object(r["a"])(o);try{var f=function(){var r=s.value,o=r.price*(t===i["b"].TWO&&r.lot?r.lot:1)*r.number_papers/u[r["currency_".concat(t,"_id")]]*u[e];if("Фонды смешанных активов"===r["instrument_type_".concat(t)]&&3===c.length){var l=n.find((function(e){return e.name.toLowerCase().trim()===r.name.toLowerCase().trim()}));if(l){var f=[{id:"stock"},{id:"bond"},{id:"alternative"}];f.forEach((function(e,t){d[t]||(d[t]=0),d[t]+=o*(l[e.id]/100)}))}}else d[a]+=o};for(l.s();!(s=l.n()).done;)f()}catch(m){l.e(m)}finally{l.f()}}));var l=0;for(var f in d)l+=d[f];for(var m in d)d[m]=Number((d[m]/l*100).toFixed(1)),(d[m]||0===d[m])&&(d[m]+="%");return d},v=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"one",r=o["a"].getters.currencies,a={};t.forEach((function(t){a[t["base_currency_".concat(n)]]||(a[t["base_currency_".concat(n)]]=0);var o=n===i["b"].TWO&&t.lot?t.lot:1;a[t["base_currency_".concat(n)]]+=t.price*t.number_papers*o/r[t["currency_".concat(n,"_id")]]*r[e]}));var c=0;for(var s in a)c+=a[s];for(var u in a)a[u]=Number((a[u]/c*100).toFixed(1)),isNaN(a[u])&&(a[u]=0),(a[u]||0===a[u])&&(a[u]+="%");return a},p=function(e){return e.duration_id===i["c"].MONTH?Number(e.term)/12:Number(e.term)},b=function(e){var t;return null===(t=a.find((function(t){return t.id===e})))||void 0===t?void 0:t.period},g=function(e){var t;return null===(t=a.find((function(t){return t.id===e})))||void 0===t?void 0:t.months},q=function(e,t,n){return(e*Math.pow(1+t,n)).toFixed(1)},j=function(e,t,n){return e*Math.pow(1+t,n)};t["e"]={currentTerm:p,currentPeriod:b,currentMonths:g,FV:q,FV1:j,getCorrectCurrency:f,getCorrectInstrumentsCurrency:m,numberSpaces:s,currectSignCurrency:c}},b680:function(e,t,n){"use strict";var r=n("23e7"),o=n("da84"),i=n("e330"),a=n("5926"),c=n("408a"),s=n("1148"),u=n("d039"),d=o.RangeError,l=o.String,f=Math.floor,m=i(s),h=i("".slice),v=i(1..toFixed),p=function(e,t,n){return 0===t?n:t%2===1?p(e,t-1,n*e):p(e*e,t/2,n)},b=function(e){var t=0,n=e;while(n>=4096)t+=12,n/=4096;while(n>=2)t+=1,n/=2;return t},g=function(e,t,n){var r=-1,o=n;while(++r<6)o+=t*e[r],e[r]=o%1e7,o=f(o/1e7)},q=function(e,t){var n=6,r=0;while(--n>=0)r+=e[n],e[n]=f(r/t),r=r%t*1e7},j=function(e){var t=6,n="";while(--t>=0)if(""!==n||0===t||0!==e[t]){var r=l(e[t]);n=""===n?r:n+m("0",7-r.length)+r}return n},O=u((function(){return"0.000"!==v(8e-5,3)||"1"!==v(.9,0)||"1.25"!==v(1.255,2)||"1000000000000000128"!==v(0xde0b6b3a7640080,0)}))||!u((function(){v({})}));r({target:"Number",proto:!0,forced:O},{toFixed:function(e){var t,n,r,o,i=c(this),s=a(e),u=[0,0,0,0,0,0],f="",v="0";if(s<0||s>20)throw d("Incorrect fraction digits");if(i!=i)return"NaN";if(i<=-1e21||i>=1e21)return l(i);if(i<0&&(f="-",i=-i),i>1e-21)if(t=b(i*p(2,69,1))-69,n=t<0?i*p(2,-t,1):i/p(2,t,1),n*=4503599627370496,t=52-t,t>0){g(u,0,n),r=s;while(r>=7)g(u,1e7,0),r-=7;g(u,p(10,r,1),0),r=t-1;while(r>=23)q(u,1<<23),r-=23;q(u,1<<r),g(u,1,1),q(u,2),v=j(u)}else g(u,0,n),g(u,1<<-t,0),v=j(u)+m("0",s);return s>0?(o=v.length,v=f+(o<=s?"0."+m("0",s-o)+v:h(v,0,o-s)+"."+h(v,o-s))):v=f+v,v}})},c4ff:function(e,t,n){},de07:function(e,t,n){"use strict";n("3148")}}]);
//# sourceMappingURL=chunk-1279e6dc.4fc8cf0b.js.map